<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Sơ đồ tổng quan hệ thống & luồng dữ liệu khép kín</title>
<style>
  :root{
    --bg:#ffffff;
    --ink:#1a1a1a;
    --muted:#666;
    --ui:#E3F2FD;
    --svc:#E8F5E9;
    --data:#FFF3E0;
    --accent:#1565C0;
    --ok:#2E7D32;
    --warn:#EF6C00;
    --line:#c8d1dc;
  }
  body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif}
  .wrap{max-width:1200px;margin:auto;padding:16px}
  h1{font-size:clamp(18px,3.5vw,24px);margin:6px 0 12px}
  .board{width:100%;aspect-ratio:16/9;border:1px solid #e5e5e5;border-radius:12px;box-shadow:0 6px 24px rgba(0,0,0,.06);overflow:hidden}
  svg{width:100%;height:100%;display:block}
  .cap{margin-top:8px;color:var(--muted);font-size:14px}
</style>
</head>
<body>
<div class="wrap">
  <h1>Sơ đồ tổng quan hệ thống &amp; luồng dữ liệu khép kín</h1>
  <div class="board">
    <svg viewBox="0 0 1200 675" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <marker id="arrow" viewBox="0 0 10 10" refX="10" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
          <path d="M 0 0 L 10 5 L 0 10 z" fill="#7c8ca0"/>
        </marker>
        <linearGradient id="halo" x1="0" x2="1">
          <stop offset="0%" stop-color="#fff" stop-opacity=".0"/>
          <stop offset="100%" stop-color="#fff" stop-opacity=".3"/>
        </linearGradient>
        <style><![CDATA[
          .box{rx:12;ry:12;stroke:#8ea6bf;stroke-width:2}
          .t{font-size:18px;fill:#1a1a1a;font-weight:700}
          .s{font-size:14px;fill:#444}
          .note{font-size:13px;fill:#666}
          .wire{stroke:#7c8ca0;stroke-width:2;fill:none;marker-end:url(#arrow)}
          .dashed{stroke-dasharray:8 6}
        ]]></style>
      </defs>

      <!-- LAYER: UI -->
      <rect x="40" y="60" width="340" height="555" class="box" fill="var(--ui)"/>
      <text x="60" y="90" class="t">Lớp Giao diện (UI)</text>
      <!-- UI modules -->
      <rect x="70" y="120" width="280" height="70" class="box" fill="#fff"/>
      <text x="90" y="155" class="s">PA – Âm vị (segment • tone • pair)</text>

      <rect x="70" y="210" width="280" height="70" class="box" fill="#fff"/>
      <text x="90" y="245" class="s">Cards – Thẻ SRS (Dễ/Vừa/Khó)</text>

      <rect x="70" y="300" width="280" height="70" class="box" fill="#fff"/>
      <text x="90" y="335" class="s">Reading – 5 bước (WCPM • % đúng)</text>

      <rect x="70" y="390" width="280" height="70" class="box" fill="#fff"/>
      <text x="90" y="425" class="s">Game – Bóng bay âm vị</text>

      <rect x="70" y="480" width="280" height="70" class="box" fill="#fff"/>
      <text x="90" y="515" class="s">Dashboard – KPIs &amp; Gợi ý</text>

      <!-- LAYER: Services -->
      <rect x="430" y="60" width="340" height="555" class="box" fill="var(--svc)"/>
      <text x="450" y="90" class="t">Lớp Dịch vụ (Services)</text>

      <rect x="460" y="120" width="280" height="58" class="box" fill="#fff"/>
      <text x="480" y="158" class="s">Adaptive Engine – chọn tag yếu</text>

      <rect x="460" y="190" width="280" height="58" class="box" fill="#fff"/>
      <text x="480" y="228" class="s">SRS Engine – SM‑2 rút gọn</text>

      <rect x="460" y="260" width="280" height="58" class="box" fill="#fff"/>
      <text x="480" y="298" class="s">TTS • Voice UI • Recorder • A11y</text>

      <rect x="460" y="330" width="280" height="58" class="box" fill="#fff"/>
      <text x="480" y="368" class="s">Reading/WCPM • Mark lỗi • Q&amp;A</text>

      <rect x="460" y="400" width="280" height="58" class="box" fill="#fff"/>
      <text x="480" y="438" class="s">Game Engine – mục tiêu tone/tag</text>

      <rect x="460" y="470" width="280" height="58" class="box" fill="#fff"/>
      <text x="480" y="508" class="s">Report/Export CSV • PDF</text>

      <!-- LAYER: Data/Sync -->
      <rect x="820" y="60" width="340" height="555" class="box" fill="var(--data)"/>
      <text x="840" y="90" class="t">Dữ liệu &amp; Đồng bộ</text>

      <rect x="850" y="120" width="280" height="58" class="box" fill="#fff"/>
      <text x="870" y="158" class="s">Store (IndexedDB): log ẩn danh</text>

      <rect x="850" y="190" width="280" height="58" class="box" fill="#fff"/>
      <text x="870" y="228" class="s">AppState • CardDeck (SRS)</text>

      <rect x="850" y="260" width="280" height="58" class="box" fill="#fff"/>
      <text x="870" y="298" class="s">Học liệu: CARDS • PA_ITEMS • PASSAGES</text>

      <rect x="850" y="360" width="280" height="120" class="box" fill="#fff"/>
      <text x="870" y="395" class="s">Sync (opt‑in) → Apps Script (HTTPS)</text>
      <text x="870" y="420" class="note">SECRET do phụ huynh cấu hình •</text>
      <text x="870" y="440" class="note">Không gửi PII/ghi âm mặc định</text>

      <!-- Wires UI <-> Services -->
      <path d="M350,155 L430,155" class="wire"/>
      <path d="M350,245 L430,245" class="wire"/>
      <path d="M350,335 L430,335" class="wire"/>
      <path d="M350,425 L430,425" class="wire"/>
      <path d="M350,515 L430,515" class="wire"/>

      <!-- Wires Services <-> Data -->
      <path d="M770,155 L820,155" class="wire"/>
      <path d="M770,225 L820,225" class="wire"/>
      <path d="M770,295 L820,295" class="wire"/>
      <path d="M770,365 L820,365" class="wire"/>
      <path d="M770,435 L820,435" class="wire"/>

      <!-- Closed loop hint -->
      <circle cx="1000" cy="560" r="40" fill="url(#halo)" stroke="#8ea6bf"/>
      <text x="1000" y="565" text-anchor="middle" class="s">Closed‑loop</text>
    </svg>
  </div>
  <div class="cap">Hình 1. Sơ đồ tổng quan hệ thống &amp; luồng dữ liệu khép kín (UI → Services → Data/Sync; log ẩn danh, đồng bộ opt‑in).</div>
</div>
</body>
</html>