# make_docde_ppt.py
# Táº¡o PowerPoint 15 slide giá»›i thiá»‡u â€œÄá»c Dá»… â€“ Há»— trá»£ tráº» rá»‘i loáº¡n Ä‘á»câ€
# pip install python-pptx

from pptx import Presentation
from pptx.util import Inches, Pt
from pptx.enum.text import PP_ALIGN, MSO_AUTO_SIZE
from pptx.dml.color import RGBColor
from pptx.enum.dml import MSO_THEME_COLOR
from pptx.enum.shapes import MSO_SHAPE

# Báº£ng mÃ u
INK = RGBColor(0x37, 0x41, 0x51)      # #374151
ACC = RGBColor(0x0e, 0xa5, 0xa0)      # #0ea5a0
MUT = RGBColor(0x51, 0x62, 0x6f)      # #51626f
PAPER = RGBColor(0xFF, 0xFF, 0xFF)    # #ffffff
PILL = RGBColor(0xF4, 0xF6, 0xFB)     # #f4f6fb
WARN = RGBColor(0xF5, 0x9E, 0x0B)     # #f59e0b
GOOD = RGBColor(0x16, 0xA3, 0x4A)     # #16a34a

prs = Presentation()
# 16:9
prs.slide_width = Inches(13.333)
prs.slide_height = Inches(7.5)

def set_title(tx, text, color=INK, size=42, bold=True):
    tx.text = text
    for p in tx.text_frame.paragraphs:
        for r in p.runs:
            r.font.bold = bold
            r.font.size = Pt(size)
            r.font.color.rgb = color

def add_footer(slide, text="Äá»c Dá»… â€“ ddh14.github.io/App_for_dyslexia_children/"):
    left = Inches(0.3)
    top = prs.slide_height - Inches(0.5)
    width = prs.slide_width - Inches(0.6)
    height = Inches(0.3)
    box = slide.shapes.add_textbox(left, top, width, height)
    tf = box.text_frame
    tf.clear()
    p = tf.paragraphs[0]
    run = p.add_run()
    run.text = text
    run.font.size = Pt(11)
    run.font.color.rgb = MUT

def add_header_bar(slide, color=ACC):
    # thanh máº£nh phÃ­a trÃªn
    slide.shapes.add_shape(MSO_SHAPE.RECTANGLE, 0, 0, prs.slide_width, Inches(0.18)).fill.solid()
    shape = slide.shapes[-1]
    shape.fill.fore_color.rgb = color
    shape.line.fill.background()

def add_pill(slide, left, top, text, fg=INK, bg=PILL):
    box = slide.shapes.add_shape(MSO_SHAPE.ROUNDED_RECTANGLE, left, top, Inches(2.2), Inches(0.6))
    box.fill.solid(); box.fill.fore_color.rgb = bg
    box.line.color.rgb = RGBColor(0xE6,0xE8,0xEE)
    tx = box.text_frame; tx.clear()
    p = tx.paragraphs[0]; r = p.add_run(); r.text = text
    r.font.size = Pt(14); r.font.color.rgb = fg
    tx.margin_left = Inches(0.2); tx.margin_right = Inches(0.2); tx.margin_top = Inches(0.05)

def add_bullets(slide, items, left=Inches(0.8), top=Inches(2.0), width=None, height=None, size=24):
    if width is None: width = prs.slide_width - Inches(1.6)
    if height is None: height = prs.slide_height - top - Inches(1.3)
    tb = slide.shapes.add_textbox(left, top, width, height)
    tf = tb.text_frame; tf.word_wrap = True; tf.auto_size = MSO_AUTO_SIZE.NONE
    tf.clear()
    for i, txt in enumerate(items):
        p = tf.paragraphs[0] if i == 0 else tf.add_paragraph()
        p.text = txt
        p.level = 0
        p.font.size = Pt(size)
        p.font.color.rgb = INK

def add_illus_block(slide, emoji="ğŸ“Š", caption="Minh hoáº¡"):
    # khá»‘i illus bÃªn pháº£i
    w = Inches(4.2); h = Inches(3.2)
    left = prs.slide_width - w - Inches(0.6)
    top = Inches(2.0)
    shape = slide.shapes.add_shape(MSO_SHAPE.ROUNDED_RECTANGLE, left, top, w, h)
    shape.fill.solid(); shape.fill.fore_color.rgb = RGBColor(0xF8,0xFA,0xFC)
    shape.line.color.rgb = RGBColor(0xE6,0xE8,0xEE)
    # emoji
    box = slide.shapes.add_textbox(left+Inches(0.2), top+Inches(0.4), w-Inches(0.4), h-Inches(1.0))
    tf = box.text_frame; tf.clear()
    p = tf.paragraphs[0]; p.alignment = PP_ALIGN.CENTER
    r = p.add_run(); r.text = emoji; r.font.size = Pt(80)
    # caption
    cap = slide.shapes.add_textbox(left, top+h-Inches(0.7), w, Inches(0.6)).text_frame
    cap.text = caption
    for r0 in cap.paragraphs[0].runs:
        r0.font.size = Pt(14); r0.font.color.rgb = MUT; cap.paragraphs[0].alignment = PP_ALIGN.CENTER

def add_title_content_slide(title, bullets, emoji="ğŸ§©", cap="Minh hoáº¡"):
    layout = prs.slide_layouts[5]  # TITLE_ONLY
    slide = prs.slides.add_slide(layout)
    add_header_bar(slide)
    set_title(slide.shapes.title.text_frame, title, size=34)
    add_bullets(slide, bullets)
    add_illus_block(slide, emoji=emoji, caption=cap)
    add_footer(slide)
    return slide

# Slide 1 â€“ BÃ¬a
slide = prs.slides.add_slide(prs.slide_layouts[6])  # blank
add_header_bar(slide)
# Khá»‘i tiÃªu Ä‘á»
title_box = slide.shapes.add_textbox(Inches(0.8), Inches(1.5), prs.slide_width - Inches(1.6), Inches(1.6))
tf = title_box.text_frame; tf.clear()
p = tf.paragraphs[0]; r = p.add_run(); r.text = "Äá»c Dá»… â€“ á»¨ng dá»¥ng há»— trá»£ tráº» rá»‘i loáº¡n Ä‘á»c"
r.font.size = Pt(44); r.font.bold = True; r.font.color.rgb = INK
sub = slide.shapes.add_textbox(Inches(0.8), Inches(3.0), Inches(8.8), Inches(1.0)).text_frame
sub.text = "Structured Literacy â€¢ PA â€¢ Cards (SRS) â€¢ Luyá»‡n Ä‘á»c â€¢ Dashboard"
for rr in sub.paragraphs[0].runs: rr.font.size = Pt(22); rr.font.color.rgb = MUT
# pills
add_pill(slide, Inches(0.8), Inches(3.8), "Voice UI ğŸ”Š", fg=INK)
add_pill(slide, Inches(3.1), Inches(3.8), "TTS & Ghi Ã¢m", fg=INK)
add_pill(slide, Inches(5.4), Inches(3.8), "Offlineâ€‘first", fg=INK)
# link
link = slide.shapes.add_textbox(Inches(0.8), Inches(4.6), Inches(9.5), Inches(0.6)).text_frame
link.text = "Demo: ddh14.github.io/App_for_dyslexia_children/"
for r in link.paragraphs[0].runs: r.font.size = Pt(16); r.font.color.rgb = ACC
# illus
add_illus_block(slide, emoji="ğŸ“–ğŸ”ŠğŸƒ", caption="PA â€¢ Cards â€¢ Reading")
add_footer(slide)

# Slide 2 â€“ Váº¥n Ä‘á» & bá»‘i cáº£nh
add_title_content_slide(
    "Váº¥n Ä‘á» & bá»‘i cáº£nh",
    [
        "Dyslexia Æ°á»›c tÃ­nh 5â€“10% HS: khÃ³ nháº­n Ã¢mâ€“chá»¯, thanh Ä‘iá»‡u, tá»‘c Ä‘á»™ Ä‘á»c.",
        "Thiáº¿u cÃ´ng cá»¥ tiáº¿ng Viá»‡t; phá»¥ huynh khÃ³ luyá»‡n Ä‘á»u má»—i ngÃ y.",
        "Cáº§n giáº£i phÃ¡p: ngáº¯n â€“ Ä‘á»u â€“ Ä‘Ãºng nhÃ³m lá»—i; cÃ³ dá»¯ liá»‡u tiáº¿n bá»™."
    ],
    emoji="ğŸ§’ğŸ“š", cap="Bá»‘i cáº£nh lá»›p há»c"
)

# Slide 3 â€“ Má»¥c tiÃªu cá»§a Äá»c Dá»…
add_title_content_slide(
    "Má»¥c tiÃªu cá»§a Äá»c Dá»…",
    [
        "Tá»± Ä‘á»™ng hoÃ¡ nháº­n diá»‡nâ€“phÃ¡t Ã¢m tiáº¿ng Viá»‡t cÃ³ dáº¥u.",
        "Giáº£m lá»—i chÃ­nh táº£ theo ngá»¯ cáº£nh (s/x; ch/tr; ng/ngh; g/gh; c/k/qu; n/lâ€¦).",
        "TÄƒng WCPM vÃ  hiá»ƒu ná»™i dung khi Ä‘á»c Ä‘oáº¡n.",
        "Theo dÃµi tiáº¿n bá»™; Ä‘á» xuáº¥t nhÃ³m Æ°u tiÃªn theo dá»¯ liá»‡u."
    ],
    emoji="ğŸ¯ğŸ“ˆ", cap="ÄÃ­ch Ä‘áº¿n"
)

# Slide 4 â€“ CÃ¡ch tiáº¿p cáº­n sÆ° pháº¡m
add_title_content_slide(
    "CÃ¡ch tiáº¿p cáº­n sÆ° pháº¡m",
    [
        "Structured Literacy + Ä‘a giÃ¡c quan (ngheâ€“nhÃ¬nâ€“nháº¥n).",
        "Chuá»—i luyá»‡n: PA â†’ Cards (SRS) â†’ Luyá»‡n Ä‘á»c/hiá»ƒu.",
        "Thá»i lÆ°á»£ng: 4â€“7 phÃºt/ngÃ y; Ä‘á»u Ä‘áº·n hÆ¡n lÃ  dÃ i.",
        "Quy trÃ¬nh: Cue â†’ Nghe/nhÃ¬n â†’ Thá»±c hiá»‡n â†’ Pháº£n há»“i â†’ Cá»§ng cá»‘."
    ],
    emoji="â¡ï¸", cap="Quy trÃ¬nh 5 bÆ°á»›c"
)

# Slide 5 â€“ Kiáº¿n trÃºc & cÃ´ng nghá»‡
add_title_content_slide(
    "Kiáº¿n trÃºc & cÃ´ng nghá»‡",
    [
        "PWA cháº¡y offline; Web/Android/iOS; Ä‘Ã³ng gÃ³i Cordova/Capacitor.",
        "TTS viâ€‘VN; Voice UI; ghi Ã¢m/Echo; Spotlight/Pacer.",
        "Dashboard â€¢ CSV/PDF; Ä‘á»“ng bá»™ Google Drive (optâ€‘in).",
        "Quyá»n riÃªng tÆ°: mÃ£ áº©n danh; khÃ´ng tá»± gá»­i ghi Ã¢m."
    ],
    emoji="ğŸ§±âš™ï¸", cap="Kiáº¿n trÃºc"
)

# Slide 6 â€“ PA: Segment
add_title_content_slide(
    "MÃ´â€‘Ä‘un PA â€“ Segment (onsetâ€“rime/cá»¥m phá»¥ Ã¢m)",
    [
        "GhÃ©p máº£nh: â€œtrâ€“anh â†’ tranhâ€, â€œghâ€“Ã© â†’ ghÃ©â€, â€œquâ€“áº£ â†’ quáº£â€.",
        "Hiá»ƒu quy táº¯c c/k/qu; ng/ngh; g/gh theo nguyÃªn Ã¢m sau.",
        "Pháº£n há»“i tá»©c thÃ¬: nhÃ¡y Ä‘Ãºng, rung sai; gá»£i Ã½ ngáº¯n theo máº«u chá»¯."
    ],
    emoji="ğŸ§©", cap="GhÃ©p máº£nh"
)

# Slide 7 â€“ PA: Tone & Pair
add_title_content_slide(
    "MÃ´â€‘Ä‘un PA â€“ Tone & Pair",
    [
        "Tone: cÃ¹ng 1 base (me/cho/que/â€¦) vá»›i 6 thanh; mÃ£ mÃ u nháº¥t quÃ¡n.",
        "Pair: cáº·p tá»‘i thiá»ƒu theo nhÃ³m lá»—i (s/x, ch/tr, ng/ngh, g/gh, c/k/qu, n/l, d/gi/r).",
        "Gá»£i Ã½ táº§ng báº­c: ğŸ¢ nghe cháº­m â†’ manh má»‘i â†’ so sÃ¡nh Ä‘á»‘i chiáº¿u."
    ],
    emoji="ğŸµâš–ï¸", cap="Thanh Ä‘iá»‡u & cáº·p tá»‘i thiá»ƒu"
)

# Slide 8 â€“ Cards (SRS)
add_title_content_slide(
    "Tháº» tá»« (Cards) â€“ Spaced Repetition",
    [
        "ÄÆ¡n vá»‹: 1 tiáº¿ng cÃ³ dáº¥u + emoji gá»£i nghÄ©a; tÃ´ mÃ u theo 6 thanh.",
        "SMâ€‘2 rÃºt gá»n: Q=5/3/1 â†’ khoáº£ng cÃ¡ch 1â€“60 ngÃ y; â€œÄ‘Ã£ vá»¯ngâ€ khi Iâ‰¥14d.",
        "VÃ²ng 60s: tÄƒng nhá»‹p, sticker/Ä‘iá»ƒm; cÃ³ thá»ƒ khÃ´ng áº£nh hÆ°á»Ÿng lá»‹ch Ã´n.",
        "Lá»c theo tag; gá»£i Ã½ tag yáº¿u theo dá»¯ liá»‡u 7 ngÃ y."
    ],
    emoji="ğŸƒ", cap="Ã”n Ä‘Ãºng lÃºc"
)

# Slide 9 â€“ Luyá»‡n Ä‘á»c 4 bÆ°á»›c
add_title_content_slide(
    "Luyá»‡n Ä‘á»c â€“ 4 bÆ°á»›c",
    [
        "B1 Chá»n cáº¥p/bÃ i; B2 Báº¯t Ä‘áº§u/Káº¿t thÃºc (WCPM, % Ä‘Ãºng).",
        "B3 ÄÃ¡nh dáº¥u lá»—i (tone, s/x, ch/tr, bá»/thÃªm Ã¢mâ€¦).",
        "B4 CÃ¢u há»i hiá»ƒu ná»™i dung; xem káº¿t quáº£.",
        "CÃ´ng cá»¥: Pacer/Spotlight; Echo 1 cÃ¢u."
    ],
    emoji="ğŸ“–â±ï¸", cap="Flow 1â†’4"
)

# Slide 10 â€“ ÄÃ¡nh giÃ¡ nhanh
add_title_content_slide(
    "ÄÃ¡nh giÃ¡ nhanh (7â€“10 phÃºt)",
    [
        "PA â€“ cÃ¹ng váº§n; RAN â€“ 50 sá»‘; Decoding â€“ giáº£ tá»«; Sight â€“ tá»« chá»©c nÄƒng.",
        "Ghi vÃ o nháº­t kÃ½; khÃ´ng pháº£i cháº©n Ä‘oÃ¡n y khoa (IDA).",
        "DÃ¹ng Ä‘á»ƒ Ä‘á»‹nh hÆ°á»›ng luyá»‡n táº­p tuáº§n."
    ],
    emoji="ğŸ§ª", cap="Screeners"
)

# Slide 11 â€“ TrÃ² chÆ¡i Ã¢m vá»‹
add_title_content_slide(
    "TrÃ² chÆ¡i Ã¢m vá»‹",
    [
        "Cháº¿ Ä‘á»™: theo thanh / theo tag; bÃ³ng Ä‘Ãºng cÃ³ vÃ²ng sÃ¡ng.",
        "Nghe máº«u, cháº¡m chá»n; Ä‘iá»ƒmâ€“thá»i gianâ€“máº¡ng rÃµ rÃ ng.",
        "TÄƒng Ä‘á»™ng lá»±c, cá»§ng cá»‘ phÃ¢n biá»‡t qua Ä‘a giÃ¡c quan."
    ],
    emoji="ğŸˆğŸ•¹ï¸", cap="Vui â€“ Ä‘Ãºng â€“ cÃ³ má»¥c tiÃªu"
)

# Slide 12 â€“ Dashboard & BÃ¡o cÃ¡o
add_title_content_slide(
    "Dashboard & BÃ¡o cÃ¡o",
    [
        "WCPM, % Ä‘Ãºng, tá»•ng lá»—i theo loáº¡i, thá»i lÆ°á»£ng luyá»‡n.",
        "PA/RAN/Decoding/Sight theo thá»i gian.",
        "Xuáº¥t CSV/PDF Ä‘á»ƒ trao Ä‘á»•i vá»›i GV/SLP.",
        "Äá»“ng bá»™ Google Drive (optâ€‘in)."
    ],
    emoji="ğŸ“Š", cap="Theo dÃµi tiáº¿n bá»™"
)

# Slide 13 â€“ A11y & Quyá»n riÃªng tÆ°
add_title_content_slide(
    "Kháº£ nÄƒng truy cáº­p & Quyá»n riÃªng tÆ°",
    [
        "Dá»… Ä‘á»c: Lexend/OpenDyslexic; giÃ£n dÃ²ng/chá»¯; nÃºt â‰¥ 44px.",
        "TÃ´n trá»ng â€œgiáº£m chuyá»ƒn Ä‘á»™ngâ€; cháº·n láº·p giá»ng nÃ³i 1.2s.",
        "áº¨n danh; khÃ´ng tá»± gá»­i ghi Ã¢m/áº£nh; Ä‘á»“ng thuáº­n rÃµ rÃ ng.",
        "Web â€¢ Android â€¢ iOS (TTS viâ€‘VN; â€œKÃ­ch hoáº¡t Ã¢m thanhâ€ láº§n Ä‘áº§u)."
    ],
    emoji="ğŸ›¡ï¸", cap="An toÃ n & thÃ¢n thiá»‡n"
)

# Slide 14 â€“ ÄÃ¡nh giÃ¡ & Káº¿t quáº£ ká»³ vá»ng
add_title_content_slide(
    "ÄÃ¡nh giÃ¡ & Káº¿t quáº£ ká»³ vá»ng",
    [
        "Bá»™ biá»ƒu máº«u: ChuyÃªn gia, Phá»¥ huynh, Há»c sinh, Phiáº¿u quan sÃ¡t, Äá»“ng thuáº­n.",
        "Chá»‰ sá»‘: % Ä‘Ãºng theo tag, WCPM, RT trung vá»‹, due completion rate, streak.",
        "Ká»³ vá»ng 4â€“6 tuáº§n: tÄƒng WCPM, giáº£m lá»—i tone & nhÃ³m Æ°u tiÃªn; há»©ng thÃº cao."
    ],
    emoji="âœ…ğŸ“ˆ", cap="Ká»³ vá»ng tiáº¿n bá»™"
)

# Slide 15 â€“ Lá»™ trÃ¬nh & KÃªu gá»i há»£p tÃ¡c
add_title_content_slide(
    "Lá»™ trÃ¬nh & KÃªu gá»i há»£p tÃ¡c",
    [
        "Q1â€“Q2/2025: hoÃ n thiá»‡n ngÃ¢n hÃ ng má»¥c (segment/tone/pair), game + bÃ¡o cÃ¡o PDF.",
        "Q3: ná»™i dung Ä‘á»c theo chá»§ Ä‘á»; cáº£i thiá»‡n SR/Echo; Ä‘a giá»ng TTS.",
        "Má»i GV/SLP/phá»¥ huynh tham gia pilot; gÃ³p Ã½ & dá»¯ liá»‡u áº©n danh.",
        "LiÃªn há»‡: ddh14.github.io/App_for_dyslexia_children/"
    ],
    emoji="ğŸ—ºï¸ğŸ¤", cap="Roadmap"
)

prs.save("DocDe_GioiThieu.pptx")
print("ÄÃ£ xuáº¥t: DocDe_GioiThieu.pptx")