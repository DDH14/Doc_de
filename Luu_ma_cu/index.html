<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Äá»c Dá»… â€“ Há»— trá»£ tráº» rá»‘i loáº¡n Ä‘á»c</title>
  <meta name="description" content="Luyá»‡n Ã¢m vá»‹, tháº» tá»«, Ä‘á»c trÃ´i cháº£y (WCPM), hiá»ƒu ná»™i dung; TTS, ghi Ã¢m, Voice UI, dashboard, xuáº¥t CSV, Ä‘á»“ng bá»™ Google Drive." />
  <link id="manifestLink" rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#FFF3D6" />
  <!-- Favicon (data URI gá»n 1 dÃ²ng Ä‘á»ƒ trÃ¡nh lá»—i phÃ¢n tÃ­ch) -->
  <link rel="icon" href="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 128 128'><rect width='128' height='128' fill='%23FFF3D6'/><text x='50%' y='58%' dominant-baseline='middle' text-anchor='middle' font-size='80' font-family='sans-serif' fill='%23111'>Ä</text></svg>">
  <link rel="stylesheet" href="styles.css" />
  <script>
    (function fixManifestPath(){
      try{
        var link = document.getElementById('manifestLink');
        if (!link) return;
        var parts = location.pathname.split('/').filter(Boolean);
        var base = (location.hostname.endsWith('.github.io') && parts.length > 0) ? ('/' + parts[0] + '/') : '/';
        link.setAttribute('href', base + 'manifest.webmanifest');
      }catch(_){/*no-op*/}
    })();
  </script>
</head>
<body>
<div class="app">
  <header class="appbar">
    <div>
      <div class="title">Äá»c Dá»… <span class="stars" id="starCount">â­ 0</span></div>
      <div class="subtitle">Ã‚m vá»‹ â€¢ Tháº» tá»« â€¢ Äá»c trÃ´i cháº£y â€¢ Dashboard</div>
    </div>
    <div class="toolbar">
      <span id="learnerBadge" class="badge">ChÆ°a thiáº¿t láº­p</span>
      <button class="tog" id="btnChild" data-voice="Báº­t hoáº·c táº¯t cháº¿ Ä‘á»™ tá»± há»c">ğŸš¸ Tá»± há»c: Táº¯t</button>
      <button class="tog" id="btnVoice" data-voice="Báº­t hoáº·c táº¯t giá»ng nÃ³i trá»£ giÃºp">ğŸ”Š Giá»ng nÃ³i: Báº­t</button>
      <button class="ghost setup-only" id="btnSettings" data-voice="CÃ i Ä‘áº·t">CÃ i Ä‘áº·t</button>
      <button class="ghost" id="btnHelp" data-voice="HÆ°á»›ng dáº«n">HÆ°á»›ng dáº«n</button>
      <button class="ghost" id="btnTheme" data-voice="Äá»•i giao diá»‡n">ğŸŒˆ Giao diá»‡n</button>
    </div>
  </header>

  <!-- Thanh dá»… Ä‘á»c -->
  <section class="a11ybar">
    <button class="ghost" id="btnDys" data-voice="Báº­t táº¯t cháº¿ Ä‘á»™ dá»… Ä‘á»c">ğŸ‘â€ğŸ—¨ Dá»… Ä‘á»c: Táº¯t</button>
    <div class="spacer"></div>
    <div class="zoom">
      <button class="ghost" id="btnFontDown" aria-label="Giáº£m cá»¡ chá»¯" data-voice="Giáº£m cá»¡ chá»¯">Aâˆ’</button>
      <span id="fontPct">100%</span>
      <button class="ghost" id="btnFontUp" aria-label="TÄƒng cá»¡ chá»¯" data-voice="TÄƒng cá»¡ chá»¯">A+</button>
    </div>
    <button class="ghost" id="btnFocusLine" data-voice="Báº­t táº¯t con trá» Ä‘á»c theo dÃ²ng">ğŸ” Con trá»: Táº¯t</button>
  </section>

  <!-- HOME -->
  <section id="screen-home" class="screen active">
    <div class="home-grid">
      <div class="card lift">
        <h3>ğŸ¯ Luyá»‡n Ã¢m vá»‹</h3>
        <div class="note">GhÃ©p Ã¢m â€“ thanh Ä‘iá»‡u â€“ cáº·p tá»‘i thiá»ƒu. NÃºt to, nghe trÆ°á»›c rá»“i chá»n.</div>
        <div class="inline-buttons" style="margin-top:10px;">
          <button class="primary" onclick="App.nav('pa')" data-voice="Luyá»‡n Ã¢m vá»‹. Báº¯t Ä‘áº§u">Báº¯t Ä‘áº§u</button>
          <button class="tts" onclick="App.speak('Luyá»‡n Ã¢m vá»‹')" data-voice="Nghe hÆ°á»›ng dáº«n Luyá»‡n Ã¢m vá»‹">ğŸ”Š Nghe</button>
        </div>
      </div>

      <div class="card lift">
        <h3>ğŸƒ Tháº» tá»«</h3>
        <div class="note">Ã”n theo nhá»‹p. Cháº¡m â€œğŸ”Šâ€ Ä‘á»ƒ nghe. Chá»n Dá»…/Vá»«a/KhÃ³ báº±ng nÃºt mÃ u.</div>
        <div class="inline-buttons" style="margin-top:10px;">
          <button class="primary" onclick="App.nav('cards')" data-voice="Tháº» tá»«. Ã”n táº­p">Ã”n táº­p</button>
        </div>
      </div>

      <div class="card lift">
        <h3>ğŸ“– Luyá»‡n Ä‘á»c </h3>
        <div class="note">B1 Chá»n chá»n â€¢ B2 Äá»c â€¢ B3 ÄÃ¡nh dáº¥u â€¢ B4 CÃ¢u há»i/Káº¿t quáº£. NÃºt to, cÃ³ lá»i nÃ³i dáº«n Ä‘Æ°á»ng.</div>
        <div class="inline-buttons" style="margin-top:10px;">
          <button class="primary" onclick="App.nav('reading')" data-voice="Äá»c Ä‘oáº¡n. Luyá»‡n Ä‘á»c">Luyá»‡n Ä‘á»c</button>
        </div>
      </div>

      <div class="card lift">
        <h3>ğŸ® TrÃ² chÆ¡i </h3>
        <div class="note">Hiá»‡n â€œMá»¥c tiÃªuâ€ rÃµ rÃ ng, nghe máº«u, bÃ³ng Ä‘Ãºng cÃ³ vÃ²ng sÃ¡ng.</div>
        <div class="inline-buttons" style="margin-top:10px;">
          <button class="primary" onclick="App.nav('game')" data-voice="VÃ o trÃ² chÆ¡i">ChÆ¡i ngay</button>
          <button class="tts" onclick="App.speak('Trong trÃ² chÆ¡i, tÃ¬m Ä‘Ãºng theo má»¥c tiÃªu hiá»ƒn thá»‹. Báº¥m Nghe máº«u Ä‘á»ƒ nghe. BÃ³ng Ä‘Ãºng sáº½ cÃ³ vÃ²ng sÃ¡ng.')" data-voice="Nghe hÆ°á»›ng dáº«n trÃ² chÆ¡i">ğŸ”Š Nghe</button>
        </div>
      </div>

      <div class="card lift">
        <h3>ğŸ“Š Dashboard</h3>
        <div class="note">Tiáº¿n bá»™, lá»—i theo loáº¡i, xuáº¥t CSV, Ä‘á»“ng bá»™.</div>
        <div class="inline-buttons" style="margin-top:10px;">
          <button class="primary" onclick="App.nav('dashboard')" data-voice="Má»Ÿ báº£ng Ä‘iá»u khiá»ƒn">Má»Ÿ Dashboard</button>
        </div>
      </div>
    </div>

    <div class="section lift">
      <div class="row">
        <div class="level-pill">Gá»£i Ã½ cáº¥p Ä‘á»™ Ä‘á»c tiáº¿p theo: <b id="nextLevelHint">â€”</b></div>
        <div class="spacer"></div>
        <button onclick="App.nav('export')" data-voice="Xuáº¥t dá»¯ liá»‡u">Xuáº¥t dá»¯ liá»‡u</button>
      </div>
    </div>
  </section>

  <!-- PA -->
  <section id="screen-pa" class="screen">
    <div class="row">
      <button onclick="App.nav('home')" data-voice="Vá» trang chÃ­nh">â† Vá» trang chÃ­nh</button>
      <div class="spacer"></div>
      <span class="badge">Ã‚m vá»‹ há»c</span>
    </div>
    <div class="section lift" id="pa-container"></div>
    <div class="help">Máº¹o: Báº¥m â€œğŸ”Šâ€ Ä‘á»ƒ nghe; nÃºt to â€“ chá»n má»™t láº§n. CÃ³ thá»ƒ cháº¡m giá»¯ 0.4s Ä‘á»ƒ nghe tÃªn nÃºt.</div>
  </section>

  <!-- Cards -->
  <section id="screen-cards" class="screen">
    <div class="row">
      <button onclick="App.nav('home')" data-voice="Vá» trang chÃ­nh">â† Vá» trang chÃ­nh</button>
      <div class="spacer"></div>
      <span class="badge">Tháº» tá»«</span>
    </div>

    <div class="section lift">
      <div class="row" style="gap:12px;">
        <label for="selCardTag" style="margin:0;">Chá»§ Ä‘á»/nhÃ³m lá»—i:</label>
        <select id="selCardTag" onchange="App.cards.setTag(this.value)" aria-label="Chá»n nhÃ³m tháº»"></select>
        <div class="spacer"></div>
        <button class="ghost" onclick="App.cards.reconcile()" data-voice="Cáº­p nháº­t tháº» má»›i theo dá»¯ liá»‡u">Cáº­p nháº­t tháº» má»›i</button>
        <span class="badge" id="cardStats">â€”</span>
      </div>
    </div>

    <div class="section lift" id="cards-container"></div>
    <div class="help">Cháº¡m â€œğŸ”Šâ€ Ä‘á»ƒ nghe rá»“i báº¥m Dá»…/Vá»«a/KhÃ³. á»¨ng dá»¥ng sáº½ tá»± háº¹n ngÃ y Ã´n.</div>
  </section>


  <!-- Reading (4 bÆ°á»›c) -->
  <section id="screen-reading" class="screen">
    <div class="row">
      <button onclick="App.nav('home')" data-voice="Vá» trang chÃ­nh">â† Vá» trang chÃ­nh</button>
      <div class="spacer"></div>
      <span class="badge">Luyá»‡n Ä‘á»c (4 bÆ°á»›c)</span>
    </div>

    <div class="section lift">
      <div class="stepper" id="readSteps">
        <div class="step active" data-step="1"><span>1</span> Chá»n</div>
        <div class="step" data-step="2"><span>2</span> Äá»c</div>
        <div class="step" data-step="3"><span>3</span> ÄÃ¡nh dáº¥u</div>
        <div class="step" data-step="4"><span>4</span> CÃ¢u há»i</div>
      </div>
    </div>

    <!-- B1: Chá»n -->
    <div class="section lift" id="readStep1">
      <div class="row" style="gap:12px;">
        <label for="selLevel" style="margin:0;">Cáº¥p Ä‘á»™:</label>
        <select id="selLevel" onchange="App.reading.chooseLevel(this.value)" aria-label="Chá»n cáº¥p Ä‘á»™"></select>

        <label for="selPassage" style="margin:0;">BÃ i:</label>
        <select id="selPassage" onchange="App.reading.choosePassage(this.value)" aria-label="Chá»n bÃ i Ä‘á»c"></select>
        <button class="ghost" onclick="App.reading.randomPassage()" data-voice="Chá»n bÃ i ngáº«u nhiÃªn">ğŸ”€ Ngáº«u nhiÃªn</button>

        <div class="spacer"></div>
        <div class="slider" data-voice="Äiá»u chá»‰nh tá»‘c Ä‘á»™ giá»ng Ä‘á»c">
          <span>ğŸ”Š Tá»‘c Ä‘á»™</span>
          <input id="rateSlider" type="range" min="0.6" max="1.4" step="0.05" value="0.9"
                 oninput="App.updateRateFromSlider(this.value)" />
          <span id="rateVal">0.90x</span>
        </div>
      </div>
      <div class="row" style="margin-top:10px;">
        <button class="primary" onclick="App.reading.goStep(2)" data-voice="Sang bÆ°á»›c Ä‘á»c">Tiáº¿p tá»¥c</button>
      </div>
    </div>

    <!-- B2: Äá»c (hiá»ƒn thá»‹ Ä‘oáº¡n dá»… Ä‘á»c) -->
    <div class="section lift" id="readStep2" style="display:none;">
      <div class="row">
        <button class="primary" id="btnStartRead" onclick="App.reading.start()" data-voice="Báº¯t Ä‘áº§u Ä‘á»c vÃ  tÃ­nh giá»">Báº¯t Ä‘áº§u</button>
        <button id="btnStopRead" class="danger" onclick="App.reading.stop()" disabled data-voice="Káº¿t thÃºc bÃ i Ä‘á»c">Káº¿t thÃºc </button>
        <button class="tts" onclick="App.reading.speakPassage()" data-voice="Nghe toÃ n bá»™ Ä‘oáº¡n">ğŸ”Š Nghe Ä‘oáº¡n</button>
        <button class="record" id="btnRec" onclick="App.reading.toggleRec()" data-voice="Ghi Ã¢m giá»ng Ä‘á»c hoáº·c nghe láº¡i">Ghi Ã¢m </button>
        <div class="spacer"></div>
        <span class="stat">â±ï¸ <span id="timer">00:00</span></span>
        <span class="stat">WCPM: <b id="statWCPM">â€”</b></span>
        <span class="stat">% Ä‘Ãºng: <b id="statAcc">â€”</b></span>
      </div>
      <!-- Äoáº¡n vÄƒn dá»… Ä‘á»c cho dyslexia -->
      <div id="passageText" class="big-text reading-plain" aria-label="Äoáº¡n vÄƒn Ä‘á»ƒ Ä‘á»c"></div>

      <div class="row" style="margin-top:10px;">
        <button class="ghost" onclick="App.reading.goStep(1)" data-voice="Quay láº¡i bÆ°á»›c chá»n">â† Quay láº¡i</button>
        <div class="spacer"></div>
        <button class="primary" onclick="App.reading.goStep(3)" data-voice="Sang bÆ°á»›c Ä‘Ã¡nh dáº¥u lá»—i">Sang bÆ°á»›c 3</button>
      </div>
    </div>

    <!-- B3: ÄÃ¡nh dáº¥u -->
    <div class="section lift" id="readStep3" style="display:none;">
      <div class="row">
        <button class="hint" onclick="App.reading.markMode('error')" id="btnErr" data-voice="Cháº¿ Ä‘á»™ Ä‘Ã¡nh dáº¥u lá»—i">ÄÃ¡nh dáº¥u lá»—i</button>
        <button class="ghost" onclick="App.reading.markMode('normal')" id="btnNorm" data-voice="Cháº¿ Ä‘á»™ bÃ¬nh thÆ°á»ng">Cháº¿ Ä‘á»™ bÃ¬nh thÆ°á»ng</button>
        <button class="ghost" onclick="App.reading.clearMarks()" data-voice="XÃ³a cÃ¡c dáº¥u lá»—i">ğŸ§¹ XÃ³a dáº¥u</button>
        <div class="spacer"></div>
        <button class="primary" onclick="App.reading.goStep(4)" data-voice="Sang cÃ¢u há»i hiá»ƒu ná»™i dung">Sang bÆ°á»›c 4</button>
      </div>
      <!-- Äoáº¡n vÄƒn cÃ³ thá»ƒ báº¥m vÃ o tá»«ng tá»« Ä‘á»ƒ Ä‘Ã¡nh dáº¥u -->
      <div id="passageView" class="big-text" style="margin-top:10px;"></div>
      <div class="help">Cháº¡m vÃ o tá»« sai Ä‘á»ƒ Ä‘Ã¡nh dáº¥u; cháº¡m láº¡i Ä‘á»ƒ bá». Nháº¥n giá»¯ Ä‘á»ƒ chá»n loáº¡i lá»—i (thanh Ä‘iá»‡u / sâ€‘x / châ€‘tr / bá» Ã¢m / thÃªm Ã¢m / khÃ¡c).</div>
    </div>

    <!-- B4: CÃ¢u há»i -->
    <div id="readStep4" class="section lift" style="display:none;">
      <h3>CÃ¢u há»i hiá»ƒu ná»™i dung</h3>
      <div id="questions"></div>
      <div class="row" style="margin-top:8px;">
        <button class="ghost" onclick="App.reading.goStep(3)" data-voice="Quay láº¡i bÆ°á»›c Ä‘Ã¡nh dáº¥u">â† Quay láº¡i</button>
        <div class="spacer"></div>
        <button class="primary" onclick="App.reading.finishComp()" data-voice="HoÃ n táº¥t cÃ¢u há»i">Xem káº¿t quáº£</button>
      </div>
    </div>
  </section>

  <!-- GAME -->
  <section id="screen-game" class="screen">
    <div class="row">
      <button onclick="App.nav('home')" data-voice="Vá» trang chÃ­nh">â† Vá» trang chÃ­nh</button>
      <div class="spacer"></div>
      <span class="badge">TrÃ² chÆ¡i: BÃ³ng bay Ã¢m vá»‹</span>
    </div>

    <div class="section lift">
      <div class="row" style="gap:10px; align-items:center;">
        <div class="targetbox" id="gameTargetBox">
          <div><b>Má»¥c tiÃªu:</b> <span id="gameTargetText">â€”</span></div>
          <div class="inline-buttons" style="margin-top:6px;">
            <button class="tts" id="btnGameSample" data-voice="Nghe máº«u má»¥c tiÃªu">ğŸ”Š Nghe máº«u</button>
            <button class="ghost" id="btnGameExplain" data-voice="Giáº£i thÃ­ch má»¥c tiÃªu">â“ Giáº£i thÃ­ch</button>
          </div>
        </div>

        <div class="spacer"></div>

        <div class="row" style="gap:8px;">
          <label style="margin:0;">Cháº¿ Ä‘á»™:</label>
          <select id="selGameMode" aria-label="Chá»n cháº¿ Ä‘á»™">
            <option value="tone">Theo thanh Ä‘iá»‡u</option>
            <option value="tag">Theo nhÃ³m lá»—i</option>
          </select>

          <span id="paneTone" class="row" style="gap:6px;">
            <label style="margin:0;">Thanh:</label>
            <select id="selGameTone" aria-label="Chá»n thanh">
              <option value="ngang">ngang</option>
              <option value="sáº¯c">sáº¯c</option>
              <option value="huyá»n">huyá»n</option>
              <option value="há»i">há»i</option>
              <option value="ngÃ£">ngÃ£</option>
              <option value="náº·ng">náº·ng</option>
            </select>
          </span>

          <span id="paneTag" class="row" style="gap:6px; display:none;">
            <label style="margin:0;">NhÃ³m:</label>
            <select id="selGameTag" aria-label="Chá»n nhÃ³m"></select>
          </span>
        </div>

        <div class="spacer"></div>

        <div class="row" style="gap:8px; align-items:center;">
          <span class="stat">ğŸ† Äiá»ƒm: <b id="gScore">0</b></span>
          <span class="stat">â±ï¸ <b id="gTime">60</b>s</span>
          <span class="stat">â¤ï¸ <b id="gLives">3</b></span>
          <button class="primary" id="btnGameStart" data-voice="Báº¯t Ä‘áº§u chÆ¡i">Báº¯t Ä‘áº§u</button>
          <button class="ghost" id="btnGameStop" disabled>Dá»«ng</button>
          <button class="ghost" id="btnGameTrain" data-voice="Báº­t cháº¿ Ä‘á»™ táº­p thá»­">ğŸ‘Ÿ Táº­p thá»­</button>
        </div>
      </div>
    </div>

    <div class="section lift">
      <canvas id="gameCanvas" width="900" height="420" aria-label="SÃ¢n chÆ¡i bÃ³ng bay"></canvas>
      <div class="help">Máº¹o: BÃ³ng Ä‘Ãºng cÃ³ <b>vÃ²ng sÃ¡ng</b> quanh bÃ³ng. Báº¥m vÃ o bÃ³ng Ä‘á»ƒ nghe tá»«; nghe ká»¹ thanh/nhÃ³m rá»“i báº¥m.</div>
    </div>
  </section>

  <!-- Dashboard -->
  <section id="screen-dashboard" class="screen">
    <div class="row">
      <button onclick="App.nav('home')" data-voice="Vá» trang chÃ­nh">â† Vá» trang chÃ­nh</button>
      <div class="spacer"></div>
      <span class="badge">Dashboard</span>
    </div>

    <div class="grid-2">
      <div class="section lift">
        <h3>WCPM theo thá»i gian</h3>
        <canvas id="chartWCPM" width="600" height="260"></canvas>
      </div>
      <div class="section lift">
        <h3>% chÃ­nh xÃ¡c theo thá»i gian</h3>
        <canvas id="chartACC" width="600" height="260"></canvas>
      </div>
      <div class="section lift">
        <h3>Tá»•ng lá»—i theo loáº¡i</h3>
        <canvas id="chartERR" width="600" height="260"></canvas>
      </div>
      <div class="section lift">
        <h3>Thá»i lÆ°á»£ng luyá»‡n táº­p</h3>
        <canvas id="chartDUR" width="600" height="260"></canvas>
      </div>
    </div>

    <div class="section lift">
      <div class="row">
        <button onclick="App.exportCSV()" data-voice="Táº£i tá»‡p CSV">Táº£i CSV</button>
        <button class="ghost" onclick="App.copyCSV()" data-voice="Sao chÃ©p CSV">Sao chÃ©p CSV</button>
        <div class="spacer"></div>
        <button class="danger" onclick="App.resetConfirm()" data-voice="XÃ³a dá»¯ liá»‡u trÃªn thiáº¿t bá»‹ nÃ y">XÃ³a dá»¯ liá»‡u (thiáº¿t bá»‹ nÃ y)</button>
      </div>
      <div class="help">CSV chá»‰ chá»©a mÃ£ áº©n danh cÃ¹ng cÃ¡c chá»‰ sá»‘ Ä‘Ã¡nh giÃ¡ (khÃ´ng chá»©a Há» tÃªn).</div>
    </div>

    <div class="section lift">
      <h3>Äá»“ng bá»™ Google Drive</h3>
      <div class="row">
        <div class="spacer"></div>
        <span class="badge" id="syncStatus">Tráº¡ng thÃ¡i: chÆ°a cáº¥u hÃ¬nh</span>
      </div>
      <div class="inline-buttons" style="margin-top:10px;">
        <button onclick="Sync.flush()" data-voice="Äá»“ng bá»™ dá»¯ liá»‡u ngay">Äá»“ng bá»™ ngay</button>
        <button class="ghost" onclick="App.testSync()" data-voice="Kiá»ƒm tra káº¿t ná»‘i Ä‘á»“ng bá»™">Kiá»ƒm tra káº¿t ná»‘i</button>
        <button class="ghost" onclick="App.showSyncHelp()" data-voice="HÆ°á»›ng dáº«n thiáº¿t láº­p Ä‘á»“ng bá»™">HÆ°á»›ng dáº«n thiáº¿t láº­p</button>
      </div>
      <div class="help">á»¨ng dá»¥ng gá»­i chá»‰ sá»‘ Ä‘á»c (WCPM, % Ä‘Ãºng, hiá»ƒu, lá»—i, thá»i lÆ°á»£ng) tá»›i Apps Script cá»§a báº¡n.</div>
    </div>
  </section>

  <!-- Export -->
  <section id="screen-export" class="screen">
    <div class="row">
      <button onclick="App.nav('home')" data-voice="Vá» trang chÃ­nh">â† Vá» trang chÃ­nh</button>
      <div class="spacer"></div>
      <span class="badge">Xuáº¥t dá»¯ liá»‡u</span>
    </div>
    <div class="section lift">
      <div class="row">
        <button onclick="App.exportCSV()" data-voice="Táº£i tá»‡p CSV">Táº£i CSV</button>
        <button class="ghost" onclick="App.copyCSV()" data-voice="Sao chÃ©p CSV">Sao chÃ©p CSV</button>
      </div>
      <div class="help">DÃ¡n vÃ o Google Sheets Ä‘á»ƒ theo dÃµi dÃ i háº¡n.</div>
    </div>
  </section>

  <!-- Settings -->
  <section id="screen-settings" class="screen">
    <div class="row">
      <button onclick="App.nav('home')" data-voice="Vá» trang chÃ­nh">â† Vá» trang chÃ­nh</button>
      <div class="spacer"></div>
      <span class="badge">CÃ i Ä‘áº·t</span>
    </div>

    <div class="section lift">
      <h3>ThÃ´ng tin há»c viÃªn & á»©ng dá»¥ng</h3>
      <div class="grid-2">
        <div>
          <label>Há» vÃ  tÃªn (chá»‰ lÆ°u trÃªn mÃ¡y, khÃ´ng gá»­i Ä‘i)</label>
          <input type="text" id="inpName" placeholder="VD: Nguyá»…n A (tÃ¹y chá»n)"/>
        </div>
        <div>
          <label>MÃ£ há»‡ thá»‘ng (tá»± cáº¥p â€“ áº©n danh)</label>
          <input type="text" id="dispSysId" disabled />
        </div>
        <div>
          <label>Tuá»•i (khÃ´ng gá»­i Ä‘i)</label>
          <input type="number" id="inpAge" min="5" max="15" />
        </div>
        <div>
          <label>Khá»‘i/lá»›p (khÃ´ng gá»­i Ä‘i)</label>
          <input type="text" id="inpGrade" placeholder="VD: Lá»›p 2" />
        </div>
        <div>
          <label>PhÃ´ng chá»¯</label>
          <select id="selFont">
            <option>Lexend</option>
            <option>OpenDyslexic</option>
            <option selected>System Sans</option>
          </select>
        </div>
        <div>
          <label>Tá»‘c Ä‘á»™ TTS (0.6â€“1.4)</label>
          <input type="number" id="inpRate" value="0.9" step="0.05" min="0.6" max="1.4" />
        </div>
        <div>
          <label>Cáº¥p Ä‘á»™ Ä‘á»c ban Ä‘áº§u</label>
          <select id="selStartLevel"></select>
        </div>
      </div>
      <div class="row" style="margin-top:10px;">
        <button class="primary" onclick="App.saveSettings()" data-voice="LÆ°u cÃ i Ä‘áº·t">LÆ°u</button>
      </div>
      <div class="help">á»¨ng dá»¥ng chá»‰ gá»­i cÃ¡c chá»‰ sá»‘ Ä‘Ã¡nh giÃ¡; Há» tÃªn/tuá»•i/lá»›p chá»‰ lÆ°u cá»¥c bá»™ Ä‘á»ƒ hiá»ƒn thá»‹.</div>
    </div>

    <div class="section lift">
      <h3>Äá»“ng bá»™ Google Drive</h3>
      <div class="grid-2">
        <div>
          <label>Äá»“ng bá»™ (Apps Script URL)</label>
          <input type="url" id="inpSyncUrl" placeholder="https://script.google.com/macros/s/XXX/exec" />
        </div>
        <div>
          <label>Máº­t mÃ£ bÃ­ máº­t (SECRET)</label>
          <input type="text" id="inpSyncSecret" placeholder="docde-secret-2025" />
        </div>
      </div>
      <div class="row" style="margin-top:10px;">
        <button onclick="App.saveSync()" data-voice="LÆ°u cÃ i Ä‘áº·t Ä‘á»“ng bá»™">LÆ°u Ä‘á»“ng bá»™</button>
        <button class="ghost" onclick="App.testSync()" data-voice="Kiá»ƒm tra káº¿t ná»‘i Ä‘á»“ng bá»™">Kiá»ƒm tra káº¿t ná»‘i</button>
      </div>
      <div class="help">DÃ¡n URL Web App tá»« Google Apps Script. SECRET pháº£i trÃ¹ng trong Script.</div>
    </div>
  </section>

  <!-- Help -->
  <div id="modalHelp" class="modal">
    <div class="dialog">
      <h3>HÆ°á»›ng dáº«n nhanh</h3>
      <ul class="help-list">
        <li data-voice="Má»¥c Ã‚m vá»‹. Máº¥t 5 Ä‘áº¿n 7 phÃºt. Chá»n theo lá»—i hay gáº·p. Nghe máº«u rá»“i báº¥m Ä‘Ã¡p Ã¡n.">
          <div class="row" style="align-items:center;">
            <b>ğŸ¯ Ã‚m vá»‹</b>
            <div class="spacer"></div>
            <span class="badge">5â€“7 phÃºt</span>
          </div>
          <div class="note">6â€“8 má»¥c tiÃªu theo lá»—i hay gáº·p. Báº¥m ğŸ”Š Ä‘á»ƒ nghe máº«u rá»“i chá»n Ä‘Ã¡p Ã¡n.</div>
          <div class="inline-buttons" style="margin-top:6px;">
            <button class="tts" onclick="App.speak('Ã‚m vá»‹. Nghe máº«u rá»“i báº¥m Ä‘Ã¡p Ã¡n Ä‘Ãºng.')" data-voice="Nghe hÆ°á»›ng dáº«n Ã‚m vá»‹">ğŸ”Š Nghe hÆ°á»›ng dáº«n</button>
            <button class="primary" onclick="App.nav('pa')" data-voice="Má»Ÿ má»¥c Ã‚m vá»‹">Má»Ÿ Ã‚m vá»‹</button>
          </div>
        </li>

        <li data-voice="Má»¥c Tháº» tá»«. Khoáº£ng 5 phÃºt. Cháº¡m nÃºt loa Ä‘á»ƒ nghe. Sau Ä‘Ã³ chá»n Dá»…, Vá»«a hoáº·c KhÃ³. á»¨ng dá»¥ng sáº½ tá»± háº¹n lá»‹ch Ã´n.">
          <div class="row" style="align-items:center;">
            <b>ğŸƒ Tháº» tá»«</b>
            <div class="spacer"></div>
            <span class="badge">~5 phÃºt</span>
          </div>
          <div class="note">10â€“15 tháº». Cháº¡m â€œğŸ”Šâ€ Ä‘á»ƒ nghe â†’ chá»n <b>Dá»…/Vá»«a/KhÃ³</b>. á»¨ng dá»¥ng tá»± Ä‘áº·t lá»‹ch Ã´n.</div>
          <div class="inline-buttons" style="margin-top:6px;">
            <button class="tts" onclick="App.speak('Tháº» tá»«. Cháº¡m nÃºt loa Ä‘á»ƒ nghe, rá»“i chá»n má»©c Dá»…, Vá»«a, hoáº·c KhÃ³.')" data-voice="Nghe hÆ°á»›ng dáº«n Tháº» tá»«">ğŸ”Š Nghe hÆ°á»›ng dáº«n</button>
            <button class="primary" onclick="App.nav('cards')" data-voice="Má»Ÿ má»¥c Tháº» tá»«">Má»Ÿ Tháº» tá»«</button>
          </div>
        </li>

        <li data-voice="Má»¥c Luyá»‡n Ä‘á»c bá»‘n bÆ°á»›c. Má»™t chá»n cáº¥p vÃ  bÃ i. Hai báº¥m báº¯t Ä‘áº§u Ä‘á»ƒ ghi Ã¢m rá»“i báº¥m káº¿t thÃºc. Ba Ä‘Ã¡nh dáº¥u lá»—i trÃªn tá»«ng tá»«. Bá»‘n tráº£ lá»i cÃ¢u há»i vÃ  xem káº¿t quáº£.">
          <div class="row" style="align-items:center;">
            <b>ğŸ“– Äá»c Ä‘oáº¡n (4 bÆ°á»›c)</b>
            <div class="spacer"></div>
            <span class="badge">1 phÃºt Ä‘á»c</span>
          </div>
          <ol class="note" style="margin:6px 0 0 18px;">
            <li>B1: Chá»n <b>cáº¥p Ä‘á»™</b> vÃ  <b>bÃ i</b>.</li>
            <li>B2: Báº¥m <b>Báº¯t Ä‘áº§u</b> Ä‘á»ƒ tÃ­nh giá» (tá»± ghi Ã¢m) â†’ báº¥m <b>Káº¿t thÃºc</b>.</li>
            <li>B3: Cháº¡m vÃ o <b>tá»«ng tá»« sai</b> Ä‘á»ƒ Ä‘Ã¡nh dáº¥u (nháº¥n giá»¯ Ä‘á»ƒ chá»n loáº¡i lá»—i).</li>
            <li>B4: Tráº£ lá»i <b>cÃ¢u há»i</b> vÃ  xem káº¿t quáº£.</li>
          </ol>
          <div class="help" style="margin-top:6px;">Máº¹o: báº­t <b>ğŸ” Con trá»</b> Ä‘á»ƒ Ä‘á»c theo dÃ²ng. Ghi Ã¢m cáº§n <b>HTTPS hoáº·c localhost</b>.</div>
          <div class="inline-buttons" style="margin-top:6px;">
            <button class="tts" onclick="App.speak('Äá»c Ä‘oáº¡n bá»‘n bÆ°á»›c. Chá»n cáº¥p vÃ  bÃ i. Báº¥m báº¯t Ä‘áº§u Ä‘á»ƒ ghi Ã¢m, sau Ä‘Ã³ báº¥m káº¿t thÃºc. ÄÃ¡nh dáº¥u lá»—i trÃªn tá»«ng tá»« rá»“i tráº£ lá»i cÃ¢u há»i.')" data-voice="Nghe hÆ°á»›ng dáº«n Luyá»‡n Ä‘á»c">ğŸ”Š Nghe hÆ°á»›ng dáº«n</button>
            <button class="primary" onclick="App.nav('reading')" data-voice="Má»Ÿ má»¥c Luyá»‡n Ä‘á»c">Má»Ÿ Luyá»‡n Ä‘á»c</button>
          </div>
        </li>

        <li data-voice="Má»¥c TrÃ² chÆ¡i. Xem má»¥c tiÃªu, báº¥m nghe máº«u. BÃ³ng Ä‘Ãºng cÃ³ vÃ²ng sÃ¡ng, hÃ£y báº¥m vÃ o bÃ³ng Ä‘Ãºng.">
          <div class="row" style="align-items:center;">
            <b>ğŸ® TrÃ² chÆ¡i</b>
            <div class="spacer"></div>
            <span class="badge">Vui vÃ  nhanh</span>
          </div>
          <div class="note">Xem â€œMá»¥c tiÃªuâ€, báº¥m â€œğŸ”Š Nghe máº«uâ€. BÃ³ng Ä‘Ãºng cÃ³ <b>vÃ²ng sÃ¡ng</b>.</div>
          <div class="inline-buttons" style="margin-top:6px;">
            <button class="tts" onclick="App.speak('Trong trÃ² chÆ¡i, hÃ£y tÃ¬m Ä‘Ãºng theo má»¥c tiÃªu hiá»ƒn thá»‹. BÃ³ng Ä‘Ãºng cÃ³ vÃ²ng sÃ¡ng.')" data-voice="Nghe hÆ°á»›ng dáº«n TrÃ² chÆ¡i">ğŸ”Š Nghe hÆ°á»›ng dáº«n</button>
            <button class="primary" onclick="App.nav('game')" data-voice="Má»Ÿ má»¥c TrÃ² chÆ¡i">Má»Ÿ TrÃ² chÆ¡i</button>
          </div>
        </li>

        <li data-voice="Giá»ng nÃ³i trá»£ giÃºp. Nháº¥n giá»¯ bá»‘n pháº§n mÆ°á»i giÃ¢y lÃªn nÃºt Ä‘á»ƒ nghe tÃªn. Báº¡n cÃ³ thá»ƒ Ä‘á»•i giao diá»‡n vÃ  cá»¡ chá»¯ trong cÃ i Ä‘áº·t.">
          <div class="row" style="align-items:center;">
            <b>ğŸ—£ï¸ Giá»ng nÃ³i & giao diá»‡n</b>
            <div class="spacer"></div>
          </div>
          <div class="note">Nháº¥n giá»¯ <b>0.4s</b> lÃªn nÃºt Ä‘á»ƒ nghe tÃªn. DÃ¹ng <b>ğŸŒˆ Giao diá»‡n</b> Ä‘á»ƒ Ä‘á»•i font/cá»¡; báº­t <b>ğŸ‘â€ğŸ—¨ Dá»… Ä‘á»c</b> náº¿u cáº§n.</div>
          <div class="inline-buttons" style="margin-top:6px;">
            <button class="ghost" onclick="App.nav('settings')" data-voice="Má»Ÿ cÃ i Ä‘áº·t">Má»Ÿ CÃ i Ä‘áº·t</button>
            <button class="ghost" onclick="document.getElementById('modalHelp').classList.remove('active')" data-voice="ÄÃ³ng vÃ  báº¯t Ä‘áº§u ngay">Báº¯t Ä‘áº§u ngay</button>
          </div>
        </li>
      </ul>
      <div class="row">
        <div class="spacer"></div>
        <button onclick="document.getElementById('modalHelp').classList.remove('active')" data-voice="ÄÃ³ng hÆ°á»›ng dáº«n">ÄÃ£ hiá»ƒu</button>
      </div>
    </div>
  </div>

  <!-- Onboarding -->
  <div id="modalOnboard" class="modal">
    <div class="dialog">
      <h3>Thiáº¿t láº­p nhanh</h3>
      <div class="grid-2">
        <div>
          <label>Há» vÃ  tÃªn (chá»‰ lÆ°u trÃªn mÃ¡y)</label>
          <input type="text" id="obName" placeholder="VD: Nguyá»…n A"/>
        </div>
        <div>
          <label>Tuá»•i (khÃ´ng gá»­i Ä‘i)</label>
          <input type="number" id="obAge" min="5" max="15"/>
        </div>
        <div>
          <label>Khá»‘i/lá»›p (khÃ´ng gá»­i Ä‘i)</label>
          <input type="text" id="obGrade" placeholder="VD: Lá»›p 2"/>
        </div>
      </div>
      <div class="row" style="margin-top:10px;">
        <button class="primary" onclick="App.finishOnboard()" data-voice="Báº¯t Ä‘áº§u sá»­ dá»¥ng">Báº¯t Ä‘áº§u</button>
      </div>
      <div class="help">á»¨ng dá»¥ng tá»± cáº¥p mÃ£ áº©n danh vÃ  chá»‰ gá»­i cÃ¡c chá»‰ sá»‘ Ä‘Ã¡nh giÃ¡. Há» tÃªn chá»‰ lÆ°u trÃªn mÃ¡y.</div>
    </div>
  </div>

  <!-- Menu lá»—i -->
  <div id="errorMenu" class="modal" style="background: transparent;">
    <div class="dialog" style="max-width:380px;">
      <h3>Chá»n loáº¡i lá»—i</h3>
      <div class="row" style="flex-wrap: wrap;">
        <button onclick="App.reading.setErrType('tone')" data-voice="Sai thanh Ä‘iá»‡u">Sai thanh Ä‘iá»‡u</button>
        <button onclick="App.reading.setErrType('sx')" data-voice="Nháº§m s vÃ  x">Nháº§m s x</button>
        <button onclick="App.reading.setErrType('chtr')" data-voice="Nháº§m ch vÃ  tr">Nháº§m ch tr</button>
        <button onclick="App.reading.setErrType('omission')" data-voice="Bá» Ã¢m hoáº·c bá» tá»«">Bá» Ã¢m</button>
        <button onclick="App.reading.setErrType('insertion')" data-voice="ThÃªm Ã¢m hoáº·c thÃªm tá»«">ThÃªm Ã¢m</button>
        <button onclick="App.reading.setErrType('other')" data-voice="Lá»—i khÃ¡c">KhÃ¡c</button>
      </div>
      <div class="row" style="margin-top:8px;">
        <div class="spacer"></div>
        <button class="ghost" onclick="document.getElementById('errorMenu').classList.remove('active')" data-voice="ÄÃ³ng báº£ng chá»n lá»—i">ÄÃ³ng</button>
      </div>
    </div>
  </div>

  <!-- KhoÃ¡/thoÃ¡t Child Mode -->
  <div class="lockbar" id="lockbar" style="display:none;">
    <span>ğŸš¸ Tá»± há»c Ä‘ang báº­t</span>
    <button class="ghost" id="btnUnlock" data-voice="Giá»¯ ba giÃ¢y Ä‘á»ƒ thoÃ¡t tá»± há»c">Giá»¯ 3s Ä‘á»ƒ thoÃ¡t</button>
  </div>

</div>

<!-- Lá»›p hiá»‡u á»©ng -->
<div id="fxLayer" class="fx-layer" aria-hidden="true"></div>

<div class="footerbar">
  <button onclick="App.nav('home')" data-voice="Trang chÃ­nh">Trang chÃ­nh</button>
  <button onclick="App.nav('pa')" data-voice="Ã‚m vá»‹">Ã‚m vá»‹</button>
  <button onclick="App.nav('cards')" data-voice="Tháº» tá»«">Tháº» tá»«</button>
  <button onclick="App.nav('reading')" data-voice="Äá»c Ä‘oáº¡n">Äá»c Ä‘oáº¡n</button>
  <button onclick="App.nav('game')" data-voice="TrÃ² chÆ¡i">TrÃ² chÆ¡i</button>
  <button onclick="App.nav('dashboard')" data-voice="Báº£ng Ä‘iá»u khiá»ƒn">Dashboard</button>
</div>

<!-- Scripts -->
<script src="./app/data.js" defer></script>
<script src="./app/store.js" defer></script>
<script src="./app/tts.js" defer></script>
<script src="./app/voiceui.js" defer></script>
<script src="./app/recorder.js" defer></script>
<script src="./app/coach.js" defer></script>
<script src="./app/utils.js" defer></script>
<script src="./app/charts.js" defer></script>
<script src="./app/adaptive.js" defer></script>
<script src="./app/sr.js" defer></script>
<script src="./app/sync.js" defer></script>

<script src="./app/modules/pa.js" defer></script>
<script src="./app/modules/cards.js" defer></script>
<script src="./app/modules/reading.js" defer></script>
<script src="./app/modules/dashboard.js" defer></script>
<script src="./app/modules/game.js" defer></script>

<script src="./app/effects.js" defer></script>
<script src="./app/a11y.js" defer></script>
<script src="./app/app.js" defer></script>
<noscript>á»¨ng dá»¥ng cáº§n JavaScript Ä‘á»ƒ hoáº¡t Ä‘á»™ng.</noscript>
  <!-- ÄÄƒng kÃ½ Service Worker -->
<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('./sw.js')
      .then(() => console.log('âœ… Service Worker registered'))
      .catch(err => console.error('âŒ SW registration failed:', err));
  }
</script>
</body>
</html>
